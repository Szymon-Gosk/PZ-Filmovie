{% extends 'base.html' %}
{% load static %}

{% block css %}
<link href="{% static 'css/styles.css' %}" type="text/css" rel="stylesheet" media="screen,projection"/>
{% endblock %}

{% block content %}


        <div class="row">

            <div class="col s12 m12">
                <div class="card horizontal">
                  <div class="card-image">
                    <img src="{{movie.Poster.url}}">
                  </div>
                  <div class="card-stacked">
                    <div class="card-content">
                      <span class="card-title"><b>{{movie.title}}</b></span>
                      <span>{{movie.type}}</span>
                      <br>
                      <p>{{movie.plot}}</p>
                      <div class="divider"></div>
                      

                      <div class="col s12 m12">
                        <div class="card-panel grey lighten-5 z-depth-1">
                          <div class="row valign-wrapper">
                            <div class="col s4 center-align">
                              {% if rating.user.profile.picture %}
                              <img src="{{ rating.user.profile.picture.url }}" alt="" class="circle">
                              {% else %}
                              <img src="{% static 'img/woman.png' %}" alt="" class="circle">
                              {% endif %}
                              <span>{{rating.user.first_name}}&nbsp{{rating.user.last_name}}</span>
                              <span>@{{rating.user.username}}</span>
                            </div>
                            <div class="col s8">
                                <h5>Rated this movie</h5>
                                <h5>{{rating.rate}} / 10</h5>
                            </div>
                          </div>
                        </div>
                      </div>



                    </div>
                  </div>
                </div>
              </div>

              <h3>Review</h3>
              <div class="divider"></div>

              <div class="row">
                <div class="col s12 m12">
                  <div class="card">
                    <div class="card-content">

                        <span class="card-title"><b>{{rating.user.first_name}}&nbsp{{rating.user.last_name}}</b><span class="right">Review<i class="material-icons right">rate_review</i></span></span>
                        <p>@{{rating.user.username}}</p>
                        <p>{{rating.date}}</p>
                        <br>
                        <p>{{rating.opinion}}
                        </p>

                        

                    </div>

                    <div class="card-action">
                        <a href="{% url 'user-rating-like' rating.user.username movie.imdbID%}"><i class="material-icons">thumb_up</i>{{rating.likes}}</a>
                        <a href="{% url 'user-rating-dislike' rating.user.username movie.imdbID%}"><i class="material-icons">thumb_down</i>{{rating.dislikes}}</a>
                    </div>

                  </div>
                </div>
              </div>


                <h3>Comments</h3>
                <div class="divider"></div>


                   <div class="col s12 m12">
                        <div class="card">
                            <div class="card-content">
                                <ul class="collection">

                                  {% for comment in comments %}
                                    <li class="collection-item avatar">

                                        {% if comment.user.profile.picture %}
                                        <img src="{{comment.user.profile.picture.url}}" alt="" class="circle">
                                        {% else %}
                                        <img src="{% static 'img/woman.png'%}" alt="" class="circle">
                                        {% endif %}


                                        <span class="title">{{comment.user.first_name}} {{comment.user.last_name}}</span>
                                        <p>@{{comment.user.username}}</p>
                                        <p>{{comment.date}}</p>
                                        <br>
                                        <p>{{comment.text}}</p>
                                        {% if user.is_authenticated and user.username == comment.user.username %}
                                        <a class="secondary-content" href="{% url 'comment-delete' user.username movie.imdbID comment.id %}"><i class="material-icons red-text">delete</i></a>
                                        {% endif %}
                                    </li>
                                  {% endfor %}

                                </ul>
                            </div>

                            <div class="card-action">
                                <form method="post" action="" role="form" class="col s12">
                                {% csrf_token %}
                                      <div class="input-field col s10">
                                      {{form.text}}
                                        <label for="textarea1">Comment</label>
                                      </div>
                                      <button type="submit" name="action" class="btn waves-effect waves-light" type="submit" name="action"><i class="material-icons right">send</i>Send</button>
                                  </form>
                            </div>

                        </div>
                    </div>

            </div>
{% endblock %}